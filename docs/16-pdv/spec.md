---
module: pdv
document: spec
status: complete
priority: mvp
last_updated: 2026-01-11
---

# PDV - EspecificaÃ§Ã£o

[â† Voltar ao MÃ³dulo](README.md)

---

## Ãndice

1. [VisÃ£o Geral](#1-visÃ£o-geral)
2. [Modelo de Dados](#2-modelo-de-dados)
3. [Interface do Display](#3-interface-do-display)
4. [Fluxo de Compra](#4-fluxo-de-compra)
5. [GestÃ£o de Estoque](#5-gestÃ£o-de-estoque)
6. [IntegraÃ§Ã£o com App](#6-integraÃ§Ã£o-com-app)
7. [Painel ADM](#7-painel-adm)
8. [SeguranÃ§a](#8-seguranÃ§a)
9. [Performance](#9-performance)

---

## 1. VisÃ£o Geral

### 1.1 Objetivo

O sistema PDV permite criar pontos de venda fÃ­sicos com displays touchscreen onde usuÃ¡rios podem comprar produtos usando pontos como moeda.

### 1.2 Caso de Uso Principal

**Geladeira de Bebidas:**
- Display 24h ao lado da geladeira
- UsuÃ¡rio seleciona produtos no display
- Paga via QR Code no app
- Pega o produto da geladeira

### 1.3 Prioridade e Status

| Item | Valor |
|------|-------|
| Prioridade | ğŸ”´ MVP |
| Status | ğŸŸ¡ Em EspecificaÃ§Ã£o |
| Interfaces | Display (Kiosk), App (User), Web (ADM) |

---

## 2. Modelo de Dados

### 2.1 PDV

```json
{
  "id": "uuid",
  "name": "Geladeira - Sede",
  "location": "Corredor Principal",
  "status": "active",
  "display_config": {
    "theme": "default",
    "idle_timeout": 60,
    "checkout_timeout": 300
  },
  "created_at": "2026-01-01T00:00:00Z",
  "updated_at": "2026-01-11T00:00:00Z"
}
```

| Campo | Tipo | DescriÃ§Ã£o |
|-------|------|-----------|
| `id` | UUID | Identificador Ãºnico |
| `name` | String | Nome do PDV |
| `location` | String | LocalizaÃ§Ã£o fÃ­sica |
| `status` | Enum | `active`, `inactive`, `maintenance` |
| `display_config` | JSON | ConfiguraÃ§Ãµes do display |

### 2.2 Produto do PDV

```json
{
  "id": "uuid",
  "pdv_id": "uuid",
  "name": "Ãgua Mineral 500ml",
  "description": "Ãgua mineral sem gÃ¡s",
  "image_url": "https://...",
  "price_points": 10,
  "category": "Bebidas",
  "stock": 24,
  "is_active": true,
  "created_at": "2026-01-01T00:00:00Z"
}
```

| Campo | Tipo | DescriÃ§Ã£o |
|-------|------|-----------|
| `pdv_id` | UUID | PDV ao qual pertence |
| `name` | String | Nome do produto |
| `price_points` | Integer | PreÃ§o em pontos |
| `stock` | Integer | Quantidade em estoque |
| `is_active` | Boolean | Se estÃ¡ disponÃ­vel |

### 2.3 Checkout

```json
{
  "id": "uuid",
  "code": "abc123",
  "pdv_id": "uuid",
  "items": [
    {
      "product_id": "uuid",
      "name": "Ãgua Mineral 500ml",
      "quantity": 1,
      "unit_price": 10,
      "total_price": 10
    }
  ],
  "total": 25,
  "status": "pending",
  "qr_code_url": "https://...",
  "created_at": "2026-01-11T10:30:00Z",
  "expires_at": "2026-01-11T10:35:00Z",
  "paid_at": null,
  "paid_by_user_id": null
}
```

| Campo | Tipo | DescriÃ§Ã£o |
|-------|------|-----------|
| `code` | String | CÃ³digo Ãºnico do checkout |
| `items` | Array | Produtos no carrinho |
| `total` | Integer | Total em pontos |
| `status` | Enum | `pending`, `paid`, `expired`, `cancelled` |
| `expires_at` | DateTime | Validade do QR (5 min) |

### 2.4 Venda

```json
{
  "id": "uuid",
  "checkout_id": "uuid",
  "pdv_id": "uuid",
  "user_id": "uuid",
  "items": [...],
  "total": 25,
  "transaction_id": "uuid",
  "created_at": "2026-01-11T10:31:00Z"
}
```

---

## 3. Interface do Display

### 3.1 Tela Inicial (Idle)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚                      [LOGO A-HUB]                           â”‚
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚              Toque para comeÃ§ar                             â”‚
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  Geladeira - Sede                         10:30            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- Exibida apÃ³s `idle_timeout` segundos de inatividade
- Qualquer toque inicia sessÃ£o de compra
- Exibe nome do PDV e horÃ¡rio

### 3.2 Tela de CatÃ¡logo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Geladeira - Sede                    [Carrinho ğŸ›’ 2]        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Bebidas                                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚   [Foto]    â”‚ â”‚   [Foto]    â”‚ â”‚   [Foto]    â”‚           â”‚
â”‚  â”‚             â”‚ â”‚             â”‚ â”‚             â”‚           â”‚
â”‚  â”‚ Ãgua 500ml  â”‚ â”‚ Refri Cola  â”‚ â”‚ Suco Laranjaâ”‚           â”‚
â”‚  â”‚   10 pts    â”‚ â”‚   15 pts    â”‚ â”‚   12 pts    â”‚           â”‚
â”‚  â”‚  [Adicionar]â”‚ â”‚  [Adicionar]â”‚ â”‚ [Esgotado]  â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚   [Foto]    â”‚ â”‚   [Foto]    â”‚                           â”‚
â”‚  â”‚             â”‚ â”‚             â”‚                           â”‚
â”‚  â”‚ EnergÃ©tico  â”‚ â”‚ Ãgua c/ GÃ¡s â”‚                           â”‚
â”‚  â”‚   20 pts    â”‚ â”‚   10 pts    â”‚                           â”‚
â”‚  â”‚  [Adicionar]â”‚ â”‚  [Adicionar]â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  [                  Ir para Checkout                  ]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 Tela de Carrinho/Checkout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† Voltar                                   Seu Carrinho    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [Foto] Ãgua Mineral 500ml                           â”‚   â”‚
â”‚  â”‚        1x            10 pts    [-] [1] [+]  [ğŸ—‘ï¸]   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [Foto] Refrigerante Cola                            â”‚   â”‚
â”‚  â”‚        1x            15 pts    [-] [1] [+]  [ğŸ—‘ï¸]   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                             â”‚
â”‚                         TOTAL: 25 pts                       â”‚
â”‚                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                             â”‚
â”‚  [                  Gerar QR de Pagamento               ]   â”‚
â”‚                                                             â”‚
â”‚  [                       Cancelar                       ]   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.4 Tela de QR Code (Aguardando Pagamento)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Pagamento                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚           Escaneie o QR Code com o App A-hub               â”‚
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚              â”‚                         â”‚                    â”‚
â”‚              â”‚                         â”‚                    â”‚
â”‚              â”‚       [QR CODE]         â”‚                    â”‚
â”‚              â”‚                         â”‚                    â”‚
â”‚              â”‚                         â”‚                    â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚                    Total: 25 pts                            â”‚
â”‚                                                             â”‚
â”‚              Aguardando pagamento...                        â”‚
â”‚              â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘                      â”‚
â”‚              Expira em: 4:32                                â”‚
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚  [                       Cancelar                       ]   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.5 Tela de Sucesso

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚                          âœ“                                  â”‚
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚               Pagamento Confirmado!                         â”‚
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚               Pode retirar seu produto                      â”‚
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚               Obrigado pela compra!                         â”‚
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚           (Voltando Ã  tela inicial em 5s...)               â”‚
â”‚                                                             â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Fluxo de Compra

### 4.1 Diagrama de SequÃªncia

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Display â”‚      â”‚Backend â”‚      â”‚  App   â”‚      â”‚Backend â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
    â”‚               â”‚               â”‚               â”‚
    â”‚ Selecionar    â”‚               â”‚               â”‚
    â”‚ produtos      â”‚               â”‚               â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚               â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚
    â”‚ POST checkout â”‚               â”‚               â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚               â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚
    â”‚ QR Code       â”‚               â”‚               â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚               â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚
    â”‚ Exibe QR      â”‚               â”‚               â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚               â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚
    â”‚               â”‚  Escanear QR  â”‚               â”‚
    â”‚               â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚
    â”‚               â”‚  Detalhes     â”‚               â”‚
    â”‚               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚
    â”‚               â”‚  Confirmar    â”‚               â”‚
    â”‚               â”‚  (biometria)  â”‚               â”‚
    â”‚               â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚
    â”‚               â”‚  POST pay     â”‚               â”‚
    â”‚               â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚
    â”‚               â”‚  DÃ©bito pontosâ”‚               â”‚
    â”‚               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚               â”‚               â”‚               â”‚
    â”‚               â”‚  Sucesso      â”‚               â”‚
    â”‚               â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚
    â”‚ Webhook       â”‚               â”‚               â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚               â”‚               â”‚
    â”‚ (pagamento    â”‚               â”‚               â”‚
    â”‚  confirmado)  â”‚               â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚
    â”‚ Tela sucesso  â”‚               â”‚               â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚               â”‚               â”‚
    â”‚               â”‚               â”‚               â”‚
```

### 4.2 Estados do Checkout

```
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ PENDING  â”‚
                â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                     â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚           â”‚           â”‚
         â–¼           â–¼           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  PAID  â”‚  â”‚EXPIRED â”‚  â”‚CANCELLEDâ”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| Status | DescriÃ§Ã£o |
|--------|-----------|
| `pending` | Aguardando pagamento |
| `paid` | Pagamento confirmado |
| `expired` | QR expirou (5 min) |
| `cancelled` | Cancelado pelo usuÃ¡rio |

---

## 5. GestÃ£o de Estoque

### 5.1 Regras de Estoque

- Cada produto tem estoque por PDV
- Estoque = 0 â†’ Produto exibido como "Esgotado"
- Estoque baixo (< 5) â†’ Alerta para ADM
- DÃ©bito de estoque ocorre apÃ³s pagamento confirmado

### 5.2 Fluxo de Estoque

```
1. Checkout criado â†’ Estoque NÃƒO reservado
2. Pagamento confirmado â†’ Estoque debitado
3. Checkout expirado â†’ Nenhuma alteraÃ§Ã£o
4. Checkout cancelado â†’ Nenhuma alteraÃ§Ã£o
```

### 5.3 ReposiÃ§Ã£o

- ADM acessa painel de estoque
- Seleciona PDV e produto
- Informa nova quantidade
- Sistema registra movimentaÃ§Ã£o

---

## 6. IntegraÃ§Ã£o com App

### 6.1 Estrutura do QR Code

```json
{
  "type": "pdv_payment",
  "checkout_code": "abc123",
  "pdv_id": "uuid",
  "pdv_name": "Geladeira - Sede",
  "total": 25,
  "expires_at": "2026-01-11T10:35:00Z"
}
```

### 6.2 Fluxo no App

1. Scanner detecta QR tipo `pdv_payment`
2. App busca detalhes via `GET /wallet/pdv/checkout/:code`
3. Exibe tela de confirmaÃ§Ã£o com itens e total
4. Solicita biometria
5. Executa `POST /wallet/pdv/pay`
6. Exibe tela de sucesso

### 6.3 NotificaÃ§Ã£o ao Display

- Backend envia webhook ao display
- Display recebe evento `checkout_paid`
- Atualiza tela para "Pagamento Confirmado"

---

## 7. Painel ADM

### 7.1 GestÃ£o de PDVs

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PDVs                                     [+ Novo PDV]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Geladeira - Sede                                    â”‚   â”‚
â”‚  â”‚ Status: â— Ativo    Local: Corredor Principal        â”‚   â”‚
â”‚  â”‚ Vendas hoje: 45    Receita: 520 pts                 â”‚   â”‚
â”‚  â”‚ [Editar] [Estoque] [RelatÃ³rio] [Desativar]         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Geladeira - Anexo                                   â”‚   â”‚
â”‚  â”‚ Status: â—‹ Inativo  Local: Sala de ReuniÃµes          â”‚   â”‚
â”‚  â”‚ [Editar] [Estoque] [RelatÃ³rio] [Ativar]            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 GestÃ£o de Estoque

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† Geladeira - Sede > Estoque            [+ Produto]        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  Produto                     PreÃ§o    Estoque    AÃ§Ã£o       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚  Ãgua Mineral 500ml          10 pts      24      [Editar]   â”‚
â”‚  Refrigerante Cola           15 pts      18      [Editar]   â”‚
â”‚  Suco de Laranja            12 pts       0      [Repor]    â”‚
â”‚  EnergÃ©tico                  20 pts       8      [Editar]   â”‚
â”‚  Ãgua com GÃ¡s               10 pts      12      [Editar]   â”‚
â”‚                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  Total de produtos: 5                                       â”‚
â”‚  Produtos esgotados: 1                                      â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.3 RelatÃ³rios

**RelatÃ³rio por PDV:**
- Vendas por perÃ­odo (dia, semana, mÃªs)
- Receita em pontos
- Produtos mais vendidos
- HorÃ¡rios de pico

**RelatÃ³rio por Produto:**
- Vendas totais
- Receita gerada
- Estoque atual vs. vendido

---

## 8. SeguranÃ§a

### 8.1 AutenticaÃ§Ã£o do Display

- Display autentica via API Key + Secret
- RenovaÃ§Ã£o automÃ¡tica de tokens
- IP whitelist opcional

### 8.2 QR Code

- Validade: 5 minutos
- CÃ³digo Ãºnico por checkout
- NÃ£o pode ser reutilizado apÃ³s pagamento

### 8.3 Pagamento

- Requer biometria no app
- ValidaÃ§Ã£o de saldo no servidor
- TransaÃ§Ã£o atÃ´mica (dÃ©bito + venda)

---

## 9. Performance

### 9.1 Metas

| OperaÃ§Ã£o | Meta |
|----------|------|
| Carregar catÃ¡logo | < 2s |
| Gerar checkout | < 1s |
| Processar pagamento | < 3s |
| Atualizar display apÃ³s pagamento | < 2s |

### 9.2 Cache

- CatÃ¡logo cacheado no display (5 min)
- Estoque atualizado em tempo real via WebSocket
- Imagens de produtos prÃ©-carregadas

### 9.3 ResiliÃªncia

- Display funciona offline com catÃ¡logo cacheado
- Checkout requer conexÃ£o
- Retry automÃ¡tico em falhas de rede

---

## Relacionados

- [API](api.md) - Endpoints
- [CritÃ©rios de AceitaÃ§Ã£o](acceptance-criteria.md) - Checklist
- [Sistema de Pontos](../06-sistema-pontos/) - DÃ©bito de pontos
- [Minha Carteira](../05-minha-carteira/) - Interface de pagamento
